
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  
  <!-- Licensed under the Apache 2.0 License -->
  <link rel="stylesheet" type="text/css" href="../_static/fonts/open-sans/stylesheet.css" />
  <!-- Licensed under the SIL Open Font License -->
  <link rel="stylesheet" type="text/css" href="../_static/fonts/source-serif-pro/source-serif-pro.css" />
  <link rel="stylesheet" type="text/css" href="../_static/css/bootstrap.min.css" />
  <link rel="stylesheet" type="text/css" href="../_static/css/bootstrap-theme.min.css" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
    <title>Network Operating System Interface &#8212; Open Network Install Environment  documentation</title>
    <link rel="stylesheet" href="../_static/guzzle.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <link rel="shortcut icon" href="../_static/onie-favicon-16x16.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Updating ONIE" href="updater.html" />
    <link rel="prev" title="Image Discovery and Execution" href="discovery.html" />
  
   

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="updater.html" title="Updating ONIE"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="discovery.html" title="Image Discovery and Execution"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Open Network Install Environment  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >Design Specification</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="operating_sw_design.html" accesskey="U">Operating Software Design</a> &#187;</li> 
      </ul>
    </div>
    <div class="container-wrapper">

      <div id="mobile-toggle">
        <a href="#"><span class="glyphicon glyphicon-align-justify" aria-hidden="true"></span></a>
      </div>
  <div id="left-column">
    <div class="sphinxsidebar">
  <a href="
      ../index.html" class="logo">
  
  <img src="../_static/ONIE-logo-green-160x60.png" class="logo" />
  </a>
  <center><a href="https://github.com/opencomputeproject/onie" class="logo">
  <svg class="octicon-mark-github" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"/></svg>
  opencomputeproject/onie</a></center>

<div class="sidebar-block">
  <div class="sidebar-wrapper">
    <h2>Table Of Contents</h2>
  </div>
  <div class="sidebar-toc">
    
    
      <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../overview/index.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../download/index.html">Download</a></li>
<li class="toctree-l1"><a class="reference internal" href="../community/index.html">Community</a></li>
<li class="toctree-l1"><a class="reference internal" href="../news/index.html">News</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user-guide/index.html">User Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Design Specification</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="hw_requirements.html">Switch Hardware Requirements</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="operating_sw_design.html">Operating Software Design</a></li>
<li class="toctree-l2"><a class="reference internal" href="x86_arch_design.html">x86 CPU Architecture Design</a></li>
<li class="toctree-l2"><a class="reference internal" href="uboot_arch_design.html">U-Boot Platform Architecture Design</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../testing/index.html">Unit Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developers/index.html">For Developers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cli/index.html">Command Line Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/index.html">FAQ</a></li>
</ul>

    
  </div>
</div>
<div class="sidebar-block">
  <div class="sidebar-wrapper">
    <h2>Contents</h2>
    <div class="sidebar-localtoc">
      <ul>
<li><a class="reference internal" href="#">Network Operating System Interface</a><ul>
<li><a class="reference internal" href="#nos-installer">NOS Installer</a><ul>
<li><a class="reference internal" href="#system-information">System Information</a></li>
</ul>
</li>
<li><a class="reference internal" href="#reinstalling-or-installing-a-different-nos">Reinstalling or Installing a Different NOS</a></li>
<li><a class="reference internal" href="#nos-uninstall">NOS Uninstall</a></li>
<li><a class="reference internal" href="#rescue-and-recovery">Rescue and Recovery</a></li>
<li><a class="reference internal" href="#updating-and-embedding-onie">Updating and Embedding ONIE</a></li>
</ul>
</li>
</ul>

    </div>
  </div>
</div>
<div class="sidebar-block">
  <div class="sidebar-wrapper">
    <div id="main-search">
      <form class="form-inline" action="../search.html" method="GET" role="form">
        <div class="input-group">
          <input name="q" type="text" class="form-control" placeholder="Search...">
        </div>
        <input type="hidden" name="check_keywords" value="yes" />
        <input type="hidden" name="area" value="default" />
      </form>
    </div>
  </div>
</div>
      
    </div>
  </div>
        <div id="right-column">
          
          <div role="navigation" aria-label="breadcrumbs navigation">
            <ol class="breadcrumb">
              <li><a href="../index.html">Home</a></li>
              
                <li><a href="index.html">Design Specification</a></li>
              
                <li><a href="operating_sw_design.html">Operating Software Design</a></li>
              
              <li>Network Operating System Interface</li>
            </ol>
          </div>
          
          <div class="document clearer body">
            
  <div class="section" id="network-operating-system-interface">
<span id="nos-interface"></span><h1>Network Operating System Interface<a class="headerlink" href="#network-operating-system-interface" title="Permalink to this headline">¶</a></h1>
<p>ONIE provides an environment for a network operating system (NOS) to perform
system provisioning and maintainance operations, including:</p>
<ul class="simple">
<li>Installing the NOS into the hardware</li>
<li>Reinstalling a different NOS</li>
<li>Uninstalling the current NOS</li>
<li>Embeding ONIE (wipes out everything, leaving only the new ONIE)</li>
<li>Updating ONIE (updates the current ONIE with a new version)</li>
<li>Rescue and recovery</li>
</ul>
<p>This environment forms an interface between ONIE and the NOS.</p>
<div class="section" id="nos-installer">
<span id="nos-intf-installer"></span><h2>NOS Installer<a class="headerlink" href="#nos-installer" title="Permalink to this headline">¶</a></h2>
<p>ONIE puts a small number of requirements on the NOS installer.</p>
<p>First, the installer <strong>must</strong> update the boot environment so that the
NOS boots at the next reboot.</p>
<p>How this is done depends on the specific CPU architecture.  See these
sections for the corresponding CPU architectures:</p>
<ul class="simple">
<li><a class="reference internal" href="uboot_nos_interface.html#uboot-nos-intf-installer"><span class="std std-ref">U-Boot platform NOS Installer</span></a></li>
<li><a class="reference internal" href="x86_nos_interface.html#x86-nos-intf-installer"><span class="std std-ref">x86 NOS Installer</span></a></li>
</ul>
<p>Second, at the conclusion of a successful NOS install, the install
<em>should</em> call <code class="docutils literal notranslate"><span class="pre">onie-nos-mode</span> <span class="pre">-s</span></code>.  This allows ONIE to be more “user
friendly” on subsequent boots.  See <a class="reference internal" href="../cli/index.html#cli-onie-nos-mode"><span class="std std-ref">onie-nos-mode</span></a>.</p>
<p>Other than that, the NOS installer can do whatever is necessary to
persistently install the operating system into the hardware; the
installer has a lot of flexibility.</p>
<p>Some examples of what an installer could do:</p>
<ul class="simple">
<li>Fetch additional binaries and configuration files via HTTP</li>
<li>Chat with inventory control systems via HTTP</li>
<li>Download a new kernel+initramfs and <a class="reference external" href="http://linux.die.net/man/8/kexec">kexec(8)</a> into it</li>
</ul>
<div class="section" id="system-information">
<span id="cmd-onie-sysinfo"></span><h3>System Information<a class="headerlink" href="#system-information" title="Permalink to this headline">¶</a></h3>
<p>Within the running ONIE context, an installer often needs to know
various information about the running system.  ONIE provides the
<code class="docutils literal notranslate"><span class="pre">onie-sysinfo</span></code> command for this purpose.</p>
<p>For details, see <a class="reference internal" href="../cli/index.html#cli-onie-sysinfo"><span class="std std-ref">onie-sysinfo</span></a>.</p>
</div>
</div>
<div class="section" id="reinstalling-or-installing-a-different-nos">
<span id="nos-intf-reinstaller"></span><h2>Reinstalling or Installing a Different NOS<a class="headerlink" href="#reinstalling-or-installing-a-different-nos" title="Permalink to this headline">¶</a></h2>
<p>From the running NOS, it is possible to instruct ONIE to return to the
initial discovery and installation phase.  This could be used to
reinstall the current NOS or to install a different NOS.</p>
<p>How to invoke the install operation depends on the specific CPU
architecture.  See these sections for the corresponding CPU
architectures:</p>
<ul class="simple">
<li><a class="reference internal" href="uboot_nos_interface.html#uboot-nos-intf-reinstaller"><span class="std std-ref">U-Boot platform Reinstalling or Installing a Different NOS</span></a></li>
<li><a class="reference internal" href="x86_nos_interface.html#x86-nos-intf-reinstaller"><span class="std std-ref">x86 Reinstalling or Installing a Different NOS</span></a></li>
</ul>
</div>
<div class="section" id="nos-uninstall">
<span id="nos-intf-uninstall"></span><h2>NOS Uninstall<a class="headerlink" href="#nos-uninstall" title="Permalink to this headline">¶</a></h2>
<p>ONIE has an uninstall operation that wipes out the unused portions of
the attached mass storage devices (like an mSATA card or USB NAND
flash). The only thing untouched is ONIE itself.  This is a
“reset to factory defaults”-like operation.</p>
<p>How to invoke the uninstall operation depends on the specific CPU
architecture.  See these sections for the corresponding CPU
architectures:</p>
<ul class="simple">
<li><a class="reference internal" href="uboot_nos_interface.html#uboot-nos-intf-uninstall"><span class="std std-ref">U-Boot platform NOS Uninstall</span></a></li>
<li><a class="reference internal" href="x86_nos_interface.html#x86-nos-intf-uninstall"><span class="std std-ref">x86 NOS Uninstall</span></a></li>
</ul>
<p>Following the uninstall process, the system returns to the discovery
and installation phase.</p>
</div>
<div class="section" id="rescue-and-recovery">
<span id="nos-intf-rescue"></span><h2>Rescue and Recovery<a class="headerlink" href="#rescue-and-recovery" title="Permalink to this headline">¶</a></h2>
<p>ONIE provides a rescue and recovery mode, which is useful mostly during
development, but is potentially useful when trying to recover a broken
system.</p>
<p>The rescue mode is the same as the discovery and installation phase,
but the discovery mechanism is disabled.  ONIE does <strong>not</strong> try to
locate and install an image; it simply sits there allowing you to
troubleshoot the system.</p>
<p>In this mode you can connect to ONIE via the serial console or via
telnet.  You can use the available BusyBox tools to try and fix a
problem.  Or use <a class="reference external" href="http://linux.die.net/man/1/wget">wget</a> to download
more tools and files.</p>
<p>A few useful commands included with ONIE are:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">onie-nos-install</span></code> – It takes one argument, a URL to a NOS installer.  This
command downloads and installs from the URL, just as if it had been
<em>discovered</em>.</li>
<li><code class="docutils literal notranslate"><span class="pre">onie-self-update</span></code> – It takes a URL to an ONIE updater image.
This command downloads and runs the updater, just as if it had been
<em>discovered</em>.  See the <a class="reference internal" href="updater.html#updating-onie"><span class="std std-ref">Updating ONIE</span></a> section for more about
updating ONIE.</li>
<li><code class="docutils literal notranslate"><span class="pre">onie-discovery-stop</span></code> – Stop the discovery process.  This can be
useful in debugging cases where the discovery process is interfering
with the debug.  With the discovery process disabled the system is
quiet and you can poke around.</li>
</ul>
<p>How to invoke the rescue operation depends on the specific CPU
architecture.  See these sections for the corresponding CPU
architectures:</p>
<ul class="simple">
<li><a class="reference internal" href="uboot_nos_interface.html#uboot-nos-intf-rescue"><span class="std std-ref">U-Boot platform Rescue and Recovery</span></a></li>
<li><a class="reference internal" href="x86_nos_interface.html#x86-nos-intf-rescue"><span class="std std-ref">x86 Rescue and Recovery</span></a></li>
</ul>
</div>
<div class="section" id="updating-and-embedding-onie">
<span id="nos-intf-update"></span><h2>Updating and Embedding ONIE<a class="headerlink" href="#updating-and-embedding-onie" title="Permalink to this headline">¶</a></h2>
<p>ONIE provides a way to update itself, including the boot loader and
Linux kernel.  In many ways, this behaves similarly to the discovery
and installation phase, except that ONIE is looking for a different
kind of image.</p>
<p>The update operation comes in two flavors: <code class="docutils literal notranslate"><span class="pre">update</span></code> and <code class="docutils literal notranslate"><span class="pre">embed</span></code>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">update</span></code> operation will upgrade ONIE and is <strong>not</strong> destructive
to the currently installed NOS.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">embed</span></code> operation, on the other hand, is <strong>destructive</strong>.  This
operation will wipe out everything (including any installed NOS) and
install a new version of ONIE.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">At this time, the <code class="docutils literal notranslate"><span class="pre">embed</span></code> operation is available only on the x86
platform.</p>
</div>
<p>For more details on the <code class="docutils literal notranslate"><span class="pre">update</span></code> and <code class="docutils literal notranslate"><span class="pre">embed</span></code> operations see
<a class="reference internal" href="x86_nos_interface.html#x86-nos-intf-update"><span class="std std-ref">x86 Updating and Embedding ONIE</span></a> and <a class="reference internal" href="uboot_nos_interface.html#uboot-nos-intf-update"><span class="std std-ref">U-Boot platform Updating and Embedding ONIE</span></a> for the
corresponding CPU architectures.</p>
<p>See the <a class="reference internal" href="updater.html#updating-onie"><span class="std std-ref">Updating ONIE</span></a> section for more about updating ONIE.</p>
<p>How to invoke the <code class="docutils literal notranslate"><span class="pre">update</span></code> and <code class="docutils literal notranslate"><span class="pre">embed</span></code> operations depends on the
specific CPU architecture.  See these sections for the corresponding
CPU architectures:</p>
<ul class="simple">
<li><a class="reference internal" href="uboot_nos_interface.html#uboot-nos-intf-update"><span class="std std-ref">U-Boot platform Updating and Embedding ONIE</span></a></li>
<li><a class="reference internal" href="x86_nos_interface.html#x86-nos-intf-update"><span class="std std-ref">x86 Updating and Embedding ONIE</span></a></li>
</ul>
</div>
</div>


          </div>
            
  <div class="footer-relations">
    
      <div class="pull-left">
        <a class="btn btn-default" href="discovery.html" title="previous chapter (use the left arrow)">Image Discovery and Execution</a>
      </div>
    
      <div class="pull-right">
        <a class="btn btn-default" href="updater.html" title="next chapter (use the right arrow)">Updating ONIE</a>
      </div>
    </div>
    <div class="clearer"></div>
  
        </div>
        <div class="clearfix"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="updater.html" title="Updating ONIE"
             >next</a> |</li>
        <li class="right" >
          <a href="discovery.html" title="Image Discovery and Execution"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Open Network Install Environment  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >Design Specification</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="operating_sw_design.html" >Operating Software Design</a> &#187;</li> 
      </ul>
    </div>
<script type="text/javascript">
  $("#mobile-toggle a").click(function () {
    $("#left-column").toggle();
  });
</script>
<script type="text/javascript" src="../_static/js/bootstrap.js"></script>
  <div class="footer">
        &copy; Copyright 2013-2018, <a href="https://cumulusnetworks.com/">Cumulus Networks, Inc.</a>  All Rights Reserved.
  </div>
  </body>
</html>